import{j as e}from"./bootstrap-Bhj38lrG.js";import{h as g,r as l}from"./vendor-vT5NdfSc.js";import{r as o}from"./index-BRpFmTyN.js";import"./icons-okTEACyS.js";const D=()=>{var u,x;const{reservationId:n}=g(),[a,c]=l.useState(null),[j,d]=l.useState(!0),[m,p]=l.useState(null),[b,I]=l.useState(!1);l.useEffect(()=>{n&&(async()=>{d(!0);try{const s=await o.getById(n);s&&s.data?c(s.data):p("No se encontró la reserva")}catch(s){console.error("Error cargando detalles de reserva:",s),p("Error al cargar los detalles de la reserva")}finally{d(!1)}})()},[n]);const r=async t=>{try{await o.updateStatus(n,t),c(s=>({...s,status:t})),alert(`Estado de la reserva actualizado a: ${t}`)}catch(s){console.error("Error actualizando estado:",s),alert("Error al actualizar el estado de la reserva")}},N=async()=>{var t,s;try{const i={provider:"efectivo",paymentMethod:"cash",amount:((t=a.priceInfo)==null?void 0:t.totalAmount)||0,currency:((s=a.priceInfo)==null?void 0:s.currency)||"USD",paymentStatus:"approved",paidAt:new Date().toISOString()};await o.updatePayment(n,i),c(y=>({...y,paymentInfo:i})),a.status==="pending"&&await r("confirmed"),alert("Pago en efectivo registrado correctamente")}catch(i){console.error("Error registrando pago:",i),alert("Error al registrar el pago")}};if(j)return e.jsx("div",{className:"reservation-detail-loading",children:"Cargando detalles de la reserva..."});if(m)return e.jsx("div",{className:"reservation-detail-error",children:m});if(!a)return e.jsx("div",{className:"reservation-detail-error",children:"No se encontraron detalles de la reserva"});const h=new Date(a.checkIn),v=new Date(a.checkOut),f=Math.ceil((v-h)/(1e3*60*60*24));return e.jsxs("div",{className:"reservation-detail-container",children:[e.jsxs("div",{className:"reservation-detail-header",children:[e.jsx("h1",{children:"Detalles de Reserva"}),e.jsxs("div",{className:`reservation-status status-${a.status}`,children:[a.status==="pending"&&"Pendiente",a.status==="confirmed"&&"Confirmada",a.status==="cancelled"&&"Cancelada",a.status==="completed"&&"Completada"]})]}),e.jsxs("div",{className:"reservation-detail-content",children:[e.jsxs("div",{className:"reservation-section property-section",children:[e.jsx("h2",{children:"Información de la Propiedad"}),e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"label",children:"Propiedad:"}),e.jsx("span",{className:"value",children:a.propertyName})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"label",children:"ID Propiedad:"}),e.jsx("span",{className:"value",children:a.propertyId})]})]}),e.jsxs("div",{className:"reservation-section dates-section",children:[e.jsx("h2",{children:"Fechas y Huéspedes"}),e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"label",children:"Check-in:"}),e.jsx("span",{className:"value",children:h.toLocaleDateString("es-ES")})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"label",children:"Check-out:"}),e.jsx("span",{className:"value",children:v.toLocaleDateString("es-ES")})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"label",children:"Noches:"}),e.jsx("span",{className:"value",children:f})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"label",children:"Huéspedes:"}),e.jsx("span",{className:"value",children:a.guests})]})]}),e.jsxs("div",{className:"reservation-section guest-section",children:[e.jsx("h2",{children:"Información del Cliente"}),e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"label",children:"Nombre:"}),e.jsx("span",{className:"value",children:a.fullName})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"label",children:"Email:"}),e.jsx("span",{className:"value",children:a.email})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"label",children:"Teléfono:"}),e.jsx("span",{className:"value",children:a.phone||"No especificado"})]}),e.jsxs("div",{className:"detail-item",children:[e.jsxs("span",{className:"label",children:[a.idType==="dni"?"DNI":"Pasaporte",":"]}),e.jsx("span",{className:"value",children:a.dni})]})]}),e.jsxs("div",{className:"reservation-section payment-section",children:[e.jsx("h2",{children:"Información de Pago"}),(u=a.paymentInfo)!=null&&u.provider?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"label",children:"Método de Pago:"}),e.jsx("span",{className:"value",children:a.paymentInfo.provider==="efectivo"?"Efectivo":a.paymentInfo.provider})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"label",children:"Estado del Pago:"}),e.jsx("span",{className:"value",style:{color:a.paymentInfo.provider==="efectivo"&&a.paymentInfo.paymentStatus!=="completed"&&a.status!=="confirmed"&&a.status!=="completed"?"#f39c12":a.status==="confirmed"?"#28a745":"inherit"},children:a.status==="confirmed"||a.status==="completed"?"Pagado":a.paymentInfo.provider==="efectivo"?a.paymentInfo.paymentStatus==="completed"?"Completado":"Pendiente de pago":a.paymentInfo.paymentStatus==="approved"?"Aprobado":"Pendiente"})]}),a.paymentInfo.amount&&e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"label",children:"Monto:"}),e.jsxs("span",{className:"value",children:[a.paymentInfo.currency," ",a.paymentInfo.amount]})]}),a.paymentInfo.paidAt&&(a.paymentInfo.provider!=="efectivo"||a.paymentInfo.paymentStatus==="completed")&&e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"label",children:"Fecha de Pago:"}),e.jsx("span",{className:"value",children:new Date(a.paymentInfo.paidAt).toLocaleDateString("es-ES")})]}),a.paymentInfo.provider==="efectivo"&&a.paymentInfo.paymentStatus!=="completed"&&a.status!=="confirmed"&&a.status!=="completed"&&e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"label",children:"Estado:"}),e.jsx("span",{className:"value",style:{color:"#f39c12",fontWeight:"bold"},children:"⚠️ Pendiente de pago"})]}),a.status==="confirmed"&&e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"label",children:"Estado:"}),e.jsx("span",{className:"value",style:{color:"#28a745",fontWeight:"bold"},children:"✅ Pago confirmado"})]})]}):e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"label",children:"Método de Pago:"}),e.jsx("span",{className:"value no-payment",children:"No especificado (Solo efectivo disponible)"})]}),!((x=a.paymentInfo)!=null&&x.provider)&&e.jsx("button",{className:"button cash-button",onClick:N,children:"💵 Registrar Pago en Efectivo"})]}),e.jsxs("div",{className:"reservation-section message-section",children:[e.jsx("h2",{children:"Mensaje del Cliente"}),e.jsx("div",{className:"message-content",children:a.message})]}),e.jsxs("div",{className:"reservation-actions",children:[e.jsx("h2",{children:"Acciones"}),a.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"button confirm-button",onClick:()=>r("confirmed"),children:"✅ Confirmar Reserva"}),e.jsx("button",{className:"button cancel-button",onClick:()=>r("cancelled"),children:"❌ Cancelar Reserva"})]}),a.status==="confirmed"&&e.jsx("button",{className:"button complete-button",onClick:()=>r("completed"),children:"🏁 Marcar como Completada"})]})]})]})};export{D as default};
